## Library search

| –°–æ–±—ã—Ç–∏–µ         | –ù–∞–∑–≤–∞–Ω–∏–µ       | –ö–∞—Ç–µ–≥–æ—Ä–∏—è |
| :-------------- | -------------- | --------- |
| StudentCTF 2025 | Library search | WEB       |

### –û–ø–∏—Å–∞–Ω–∏–µ

> **üîç Library Trash: The Cleanup Incident**  
> _–ö–æ–≥–¥–∞ —É–±–æ—Ä–∫–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞–∑–æ–±–ª–∞—á–µ–Ω–∏—é_
> 
> –í–æ –≤—Ä–µ–º—è –ø–ª–∞–Ω–æ–≤–æ–π –æ—á–∏—Å—Ç–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –æ–±–Ω–∞—Ä—É–∂–∏–ª, —á—Ç–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ "—É–¥–∞–ª–µ–Ω–Ω—ã–µ" –¥–∞–Ω–Ω—ã–µ –≤—Å–µ –µ—â–µ –¥–æ—Å—Ç—É–ø–Ω—ã. –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏ –Ω–∞–π–¥–∏—Ç–µ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

### –†–µ—à–µ–Ω–∏–µ
–°–µ—Ä–≤–∏—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª –∏–∑ —Å–µ–±—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –¥–µ–ª–∞—Ç—å `CRUD` —Å–æ —Å–≤–æ–∏–º–∏ –∫–Ω–∏–≥–∞–º–∏, –µ—â–µ –æ–¥–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –±—ã–ª–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞. –ò–∑—É—á–∏–≤ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ–ª—É—á–∏—Ç—å —Ñ–ª–∞–≥ –º–æ–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å cookie, –∫–æ—Ç–æ—Ä–æ–≥–æ `admin`. –°–º–æ—Ç—Ä–∏–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ø–∞–ø–∫—É `/tmp/sessions`, –¥–∞ –µ—â–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏ —ç—Ç–æ —Ä–∞—Å–ø–∞–∫–æ–≤–∫—É –∞—Ä—Ö–∏–≤–∞. –ù–æ —Å—Ç–æ–∏—Ç –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏. 
###### –ü–ª–∞–Ω —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:
1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º 
```
         payload = {
            "username": username,
            "id": some_id,
            "role": "admin"
        }
```

2. –°–¥–µ–ª–∞—Ç—å –∞—Ä—Ö–∏–≤ —Å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º –∏ —É–∫–∞–∑–∞—Ç—å —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —ç—Ç–æ—Ç –Ω–∞ —Ñ–∞–π–ª –ø—Ä–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏
```
/tmp/sessions/username/session_id
```
–≥–¥–µ `username` —ç—Ç–æ –Ω–∞—à–µ –∏–º—è, –∞ `session_id` –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä.

```
# –ü–æ—Å–ª–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∞—Ä—Ö–∏–≤–∞:
session.txt        # –æ–±—ã—á–Ω—ã–π —Ñ–∞–π–ª
/tmp/sessions/username/session_id -> session.txt  # —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∞—è —Å—Å—ã–ª–∫–∞
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –ø–æ–ª—É—á–∏–º –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–µ—Å—Å–∏–µ–π —Å —Ä–æ–ª—å—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–ª–∞–¥–µ–µ–º —Ñ–ª–∞–≥–æ–º.
### –§–ª–∞–≥

```
stctf{test_flag}
```