## Обман Иллюзий

| Событие         | Название      | Категория |
| :-------------- | ------------- | --------- |
| StudentCTF 2025 | Обман Иллюзий | MISC      |

  
### Описание


> А тут у меня целый онлайн-кинотеатр для просмотра нового фильма "Обман Иллюзий"! Но кажется, что-то тут нечисто, не доверяю я админам таких сайтов... Мне удалось закинуть админу кейлоггер, может это как-то поможет мне.


### Решение
Нам выдали ссылку и pcap-файл с USB трафиком, рассмотрим сайт.

Открывая его, мы видим действительно онлайн-кинотеатр, где можно посмотреть "фильм". 

Помотрим, что содержится в панели разработчика или BurpSuite при заходе на сайт. Нам подгружается iframe, с плеером youtube, хотя "фильм" грузится не с ютуба. Пробуем посмотреть, что за youtube видео.

Ссылка пересылает нас на плейлист с двумя видео, где видео с названием `"В скором это будет очень популярное видео"` выглядит подозрительно. Похоже администратор канала накручивает просмотры на свой YouTube через онлайн-кинотеатр. Посмотрим, что у него на канале.

Там ждёт нас два видео:
1) Первое видео автора
2) Видео, на которое крутят просмотры и которое мы уже видели

Заходим на первое видео и получаем две подсказки по дальнейшему движению. 
Во-первых, стоит заметить в названиях вкладок `"NYSMF4n boost page"` (похоже, что `NYSMF4n` - это никнейм автора). 
Во-вторых, автор показывает, что явно стоит посмотреть описание канала. (получаем `/S3cre7Way7oProm0t3YTVide0UzNjcmU3V2F5N29Qcm9tMHQzWVRWaWRlMA`)

Тут догадываемся, что это директория на сайте онлайн-кинотеатра, пройдём же туда. 

Встречает нас страница входа. Логин мы уже знаем, а для пароля нам понадобится pcap-файл.

Изучаем, как можно раздекодить его. Либо пишем на основе структур пакетов сами, либо используем уже готовый вариант [парсера](https://github.com/5h4rrk/CTF-Usb_Keyboard_Parser).

Получаем пароль, заходим на сайт и получаем флаг!

### Флаг

```
stctf{test_flag}
```